using Microsoft.VisualStudio.TestTools.UnitTesting;
using LogFileHandler;
using LogLineHandler;
using Samples;

namespace SPLogLineTests
{
   public class WFPOPENTests
   {
      [TestMethod]
      public void WFPOPEN_Timestamp()
      {
         WFPOPEN spLine = new WFPOPEN(new SPLogHandler(new CreateTextStreamReaderMock()), samples_general.WFPOPEN, XFSType.WFPOPEN);
         Assert.IsTrue(spLine.Timestamp == "2023-04-04 1203:05:20.026");
      }

      [TestMethod]
      public void WFPOPEN_HResult()
      {
         WFPOPEN spLine = new WFPOPEN(new SPLogHandler(new CreateTextStreamReaderMock()), samples_general.WFPOPEN, XFSType.WFPOPEN);
         Assert.IsTrue(spLine.HResult == "");
      }

      [TestMethod]
      public void WFPOPEN_lpszLogicalName()
      {
         WFPOPEN spLine = new WFPOPEN(new SPLogHandler(new CreateTextStreamReaderMock()), samples_general.WFPOPEN, XFSType.WFPOPEN);
         Assert.IsTrue(spLine.lpszLogicalName == "Sensors");
      }

      [TestMethod]
      public void WFPOPEN_lpszAppID()
      {
         WFPOPEN spLine = new WFPOPEN(new SPLogHandler(new CreateTextStreamReaderMock()), samples_general.WFPOPEN, XFSType.WFPOPEN);
         Assert.IsTrue(spLine.lpszAppID == "NH XFS AGENT");
      }

      [TestMethod]
      public void WFPOPEN_2_Timestamp()
      {
         WFPOPEN spLine = new WFPOPEN(new SPLogHandler(new CreateTextStreamReaderMock()), samples_general.WFPOPEN2, XFSType.WFPOPEN);
         Assert.IsTrue(spLine.Timestamp == "2023-04-04 03:05:20.026");
      }

      [TestMethod]
      public void WFPOPEN_2_HResult()
      {
         WFPOPEN spLine = new WFPOPEN(new SPLogHandler(new CreateTextStreamReaderMock()), samples_general.WFPOPEN2, XFSType.WFPOPEN);
         Assert.IsTrue(spLine.HResult == "");
      }

      [TestMethod]
      public void WFPOPEN_2_lpszLogicalName()
      {
         WFPOPEN spLine = new WFPOPEN(new SPLogHandler(new CreateTextStreamReaderMock()), samples_general.WFPOPEN2, XFSType.WFPOPEN);
         Assert.IsTrue(spLine.lpszLogicalName == "Sensors");
      }

      [TestMethod]
      public void WFPOPEN_2_lpszAppID()
      {
         WFPOPEN spLine = new WFPOPEN(new SPLogHandler(new CreateTextStreamReaderMock()), samples_general.WFPOPEN2, XFSType.WFPOPEN);
         Assert.IsTrue(spLine.lpszAppID == "MoniPlus2.Loader.exe");
      }
   }
}

