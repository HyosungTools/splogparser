using Impl;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System.IO;
using System.Text;

namespace ImplTests
{
   /// <summary>
   /// Test different end-of-line scenarios when reading an nwlog file. 
   /// End-of-line is a misnomer; it's really end of information-block. 
   /// So the start could be 'lpResult =' and 30 log lines later end with '}'
   /// 
   /// Note: make sure you start the string on a new-line so you dont accidentally add a \r\n to the test. 
   /// 
   /// </summary>
   [TestClass]
   public class TraceFileReaderTests
   {
      [TestMethod]
      public void DetectEOLTailIsWellFormed()
      {
         // Test Sample Line
         string sampleFile = 
            @"			ulDispensedCount	0		0		43		219		194		846		
			ulPresentedCount	0		0		43		219		194		846		
			ulRetractedCount	0		0		0		0		0		0		
		}
	}
}16144294967295015900087402540003CDM0009FRAMEWORK00102023/01/24001200:59 14.7200011INFORMATION0028CBaseService::BroadcastEvent0048hApp=0x0F0726FA, pCursor->pData->hApp=0x0E48C40201594294967295012300087402550006COMMON0003SPI00102023/01/24001200:59 14.7200011INFORMATION0010WFPGetInfo0033HSERVICE=2, SrvcVersion=2563(A03)01234294967295016600087402560006COMMON0009FRAMEWORK00102023/01/24001200:59 14.7200011INFORMATION0028CServiceProvider::GetService0052service OK {HSERVICE[2], LogicalName[CashDispenser]}01664294967295012600087402570003CDM0003SPI00102023/01/24001200:59 14.7200011INFORMATION0026CServiceAgent::ReportEvent0023call UnPack(0x0AB27600)01264294967295015900087402580003CDM0007ACTIVEX00102023/01/24001200:59 14.7200011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000407, wParam=0x080B2D68, lParam=0x0C60CF7401594294967295013700087402590003CDM0009FRAMEWORK00102023/01/24001200:59 14.7200011INFORMATION0028CBaseService::BroadcastEvent0026pData->wClass=13, wClass=301374294967295024200087402600003CDM0003SPI00102023/01/24001200:59 14.7210007XFS_CMD0012GETINFO[303]0157hResult[0] = WFPGetInfo(
	hService = [2],
	dwCategory = [303],
	dwTimeOut = [300000],
	hWnd = [0x0002019c],
	ReqID = [17624],
	lpQueryDetails = NULL
)02424294967295016700087402610003CDM0009FRAMEWORK00102023/01/24001200:59 14.7210011INFORMATION0021CBaseService::GetInfo0063Srvc=301 ReqID=17620 Wnd=0x0002019C Cmd=301 TimeOut=300000 ";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(sampleFile)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("}\r\n}"));
      }

      [TestMethod]
      public void DetectEOLTailIsMalformed()
      {
         // Test Sample Line
         string sampleFile =
            @"		}
			ulDispensedCount = [194],
			ulPresentedCount = [194],
			ulRetractedCount = [0]
		}
}10324294967295016800087402630003CDM0007ACTIVEX00102023/01/24001200:59 14.7210011INFORMATION0031CCdmService::HandleCashUnitInfo0056GetInfo-Result[CashUnitInfo][ReqID=17621] = {hResult[0]}01684294967295015900087402640003CDM0009FRAMEWORK00102023/01/24001200:59 14.7210011INFORMATION0028CBaseService::BroadcastEvent0048hApp=0x0E48C402, pCursor->pData->hApp=0x0E48C40201594294967295019500087402650003CDM0007ACTIVEX00102023/01/24001200:59 14.7210006XFSAPI0022CService::AsyncGetInfo0097WFSAsyncGetInfo(hService=2, dwCategory=303, lpQueryDetails=0x00000000, RequestID=17624) hResult=001954294967295015700087402660013CashDispenser0009FRAMEWORK00102023/01/24001200:59 ";
         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(sampleFile)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("}\r\n}"));
      }

      [TestMethod]
      public void DetectEOLLogLineIsDmp()
      {
         // Test Sample Line
         string sampleFile = 
            @"0010h: 27 14 8C B1 6A 9E F7 64 3B 77 55 F5 70 29 97 F7 
0020h: D6 A1 35 09 18 3B 09 9B 5B 88 42 36 C4 98 7E E9 
0030h: 87 C3 C1 D7 BD 5A F3 95 5D D4 C6 53 A2 2E 6A BF ";
         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(sampleFile)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("F7 \r\n"));
      }

      [TestMethod]
      public void DetectlpResultAndContinue()
      {
         // Detect we have an lpResult on the next line and continue to the '}'
         string sampleFile = 
            @"39.7930011INFORMATION0028CServiceProvider::GetService0046service OK {HSERVICE[8], LogicalName[Sensors]}01604294967295015000087431700007Sensors0009FRAMEWORK00102023/01/24001203:00 39.7930007DEVCALL0021CBaseService::Execute0046HSERVICE[8] COMMAND[801] IN BUFFER[0x004E5E34]01504294967295014100087431710003SIU0009FRAMEWORK00102023/01/24001203:00 39.7930011INFORMATION0032CSiuService::ExecuteEnableEvents0026Enable or disable siu port01414294967295015500087431720003SIU0009FRAMEWORK00102023/01/24001203:00 39.7930011INFORMATION0020CSiuService::Execute0052Process Execute command {Command Code[801]} Success!01554294967295016200087431730007Sensors0009FRAMEWORK00102023/01/24001203:00 39.7930007DEVRETN0021CBaseService::Execute0058HSERVICE[8] COMMAND[801] HRESULT[0] OUT BUFFER[0x00000000]01624294967295012200087431740006COMMON0009FRAMEWORK00102023/01/24001203:00 39.7930011INFORMATION0015CProcessor::Run0021---- Wait [1108] ----01224294967295029900087431750006SENSOR0003SPI00102023/01/24001203:00 39.7930009XFS_EVENT0012EXECUTE[801]0209WFS_EXECUTE_COMPLETE, 
lpResult =
{
	hWnd = [0x0001040c],
	RequestID = [17762],
	hService = [8],
	tsTimestamp = [2023/01/24 03:00 39.793],
	hResult = [0],
	u.dwCommandCode = [801],
	lpBuffer = NULL
}02994294967295020100087431760006SENSOR0007ACTIVEX00102023/01/24001203:00 39.7940006XFSAPI0023CContextMgr::MgrWndProc0099WFS_EXECUTE_COMPLETE(RequestID=17762, hService=8, hResult=0, dwCommandCode=801 lpBuffer=0x00000000)02014294967295016200087431770006SENSOR0007ACTIVEX00102023/01/24001203:00 39.7940011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000408, wParam=0x00000000, lParam=0x24EE1E6401624294967295011900087431780006COMMON0003SPI00102023/01/24001203:00 39.7940011INFORMATION0010WFPGetInfo0029HSERVICE=8, SrvcVersion=3(03)01194294967295023700087431790003SIU0003SPI00102023/01/24001203:00 39.7950007XFS_CMD0012GETINFO[801]0152hResult[0] = WFPGetInfo(";
         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(sampleFile)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("\r\n}"));
         Assert.IsTrue(logLine.Contains("lpResult"));
      }

      [TestMethod]
      public void DetectEOLOutputIsTable()
      {
         // Test Sample Line - some log lines are in table form. This should read all the way down to
         // include the NoteNumbers: line 
         string sampleFile =
            @"03314294967295013600698183080003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS016 changed(1->0)01364294967295013600698183090003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS757 changed(1->0)01364294967295013600698183100003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS758 changed(1->0)01364294967295013600698183110003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS650 changed(1->0)01364294967295013600698183120003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS661 changed(0->1)01364294967295013600698183130003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS665 changed(1->0)01364294967295013600698183140003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GSA06 changed(1->0)01364294967295013600698183150003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS208 changed(1->0)01364294967295013600698183160003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS214 changed(1->0)01364294967295013600698183170003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS308 changed(1->0)01364294967295013600698183180003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS314 changed(1->0)01364294967295013600698183190003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS407 changed(1->0)01364294967295013600698183200003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS408 changed(1->0)01364294967295013600698183210003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0021CBRM5XCommand::Sensor0039oldSensorInfo.BRM5X.GS414 changed(1->0)01364294967295024200698183220003BRM0002SP00102022/12/07001220:36 11.9320011INFORMATION0023CBrmCommand::UpdateData0143bUpdateDPC=[1], bNoUpdateRetractCnt=[0], bDispense=[0], bForceUpdate=[0], bSet=[0], bLogDisplay=[1], bIgnoreRTOperCount[0], bInopWhenRCError[0]02424294967295013000698183230003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0024CBrmCommand::DumpBITInfo0030MediaInfo : [0000000000000000]01304294967295012800698183240003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0024CBrmCommand::DumpBITInfo0028JamInfo : [0000000000000000]01284294967295014500698183250003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0024CBrmCommand::DumpBITInfo0045JamInfo1 : [00000000000000000000000000000000]01454294967295014500698183260003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0024CBrmCommand::DumpBITInfo0045JamInfo2 : [00000000000000000000000111111000]01454294967295014900698183270003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0024CBrmCommand::DumpBITInfo0049ActionResult : [00000000000000000000000000000000]01494294967295019000698183280003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0023CBrmCommand::UpdateData0091SC: wCSMcount=0, wTSKcount=0, wRcCount=[0][0][0][0][0][0][0][0][0][0][0][0][0], wCSTcount=001904294967295088400698183290003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0023CBrmCommand::UpdateData0785AC: RC1=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183300003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0023CBrmCommand::UpdateData0785AC: RC2=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183310003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0023CBrmCommand::UpdateData0785AC: RC3=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183320003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0023CBrmCommand::UpdateData0785AC: RC4=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183330003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0023CBrmCommand::UpdateData0785AC: RC5=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183340003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0023CBrmCommand::UpdateData0785AC: RJC=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183350003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0023CBrmCommand::UpdateData0785AC: RC7=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183360003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0023CBrmCommand::UpdateData0785AC: UTC=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183370003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0023CBrmCommand::UpdateData0785AC: RTC=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183380003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0023CBrmCommand::UpdateData0785AC: CSM=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183390003BRM0002SP00102022/12/07001220:36 11.9480011INFORMATION0023CBrmCommand::UpdateData0785AC: TSK=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183400003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0785AC: CST=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183410003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0785CC: RC1=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183420003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0785CC: RC2=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183430003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0785CC: RC3=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183440003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0785CC: RC4=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183450003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0785CC: RC5=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295089100698183460003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0792CC: RJC=[59][0][0][0][0][0][0][0][0][1][2][1][13][19][377][54][54][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08914294967295088400698183470003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0785CC: RC7=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088400698183480003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0785CC: UTC=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][2][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08844294967295088500698183490003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0786CC: RTC=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][32][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][6]08854294967295087800698183500003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0779IC: RC1=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08784294967295087800698183510003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0779IC: RC2=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08784294967295087800698183520003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0779IC: RC3=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08784294967295087800698183530003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0779IC: RC4=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08784294967295087800698183540003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0779IC: RC5=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08784294967295087800698183550003BRM0002SP00102022/12/07001220:36 11.9640011INFORMATION0023CBrmCommand::UpdateData0779IC: RJC=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08784294967295087800698183560003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0023CBrmCommand::UpdateData0779IC: RC7=[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]08784294967295012200698183570003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0023CBrmCommand::UpdateData0023EX: RC1=[0][0][2][0][0]01224294967295012200698183580003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0023CBrmCommand::UpdateData0023EX: RC2=[0][0][0][0][0]01224294967295012200698183590003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0023CBrmCommand::UpdateData0023EX: RC3=[0][0][2][0][0]01224294967295012900698183600003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0023CBrmCommand::UpdateData0030EX: RC4=[38][0][2][1910][1853]01294294967295012200698183610003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0023CBrmCommand::UpdateData0023EX: RC5=[0][0][0][0][0]01224294967295012400698183620003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0023CBrmCommand::UpdateData0025EX: RJC=[0][0][580][0][0]01244294967295012200698183630003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0023CBrmCommand::UpdateData0023EX: RC7=[0][0][0][0][0]01224294967295013300698183640003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0023CBrmCommand::UpdateData0034RCStatus: 21 21 21 22 60 20 60 60 01334294967295011300698183650003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0023CBrmCommand::UpdateData0014UTCStatus: 01 01134294967295011300698183660003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0023CBrmCommand::UpdateData0014RTCStatus: 01 01134294967295014900698183670003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0023CBrmCommand::UpdateData0050CSTInop:[0][0][0][0][0][0][0][0][0][0][0][0][0][0]01494294967295203800698183680003BRM0002SP00102022/12/07001220:36 11.9790011INFORMATION0024CBrmCommand::DumpPCUInfo1938# PCUInfo
usCount=7
szPositionName:	  RTC	  RJC	  RC1	  RC2	  RC3	  RC4	  DPC	
szUnitID:		RTCST	RJCST	CST_A	CST_B	CST_C	CST_D	CST_F	
szCstType:	00000	00000	10001	10001	10001	10001	00000	
cSerialNum:     	CMBJ200047	CGJX465189	CGJX464260	CGJX465724	CGJX460744	CMBJ200047	
ulCashInCount:	    2	   38	    2	    0	    2	    2	  580	
ulCount:		    2	   38	    0	    0	    0	    0	  580	
ulMaximum:	   80	  210	    0	    0	    0	    0	 1400	
usPStatus:	    0	    0	    4	    4	    4	    3	    0	
bHardwareSensors:	    1	    1	    1	    1	    1	    1	    1	
ulInitialCount:	    0	    0	    0	    0	    0	    0	    0	
ulDispensedCount:	    0	    0	    0	    0	    0	 1910	    0	
ulPresentedCount:	    0	    0	    0	    0	    0	 1853	    0	
ulRetractedCount:	    0	    0	    0	    0	    0	    0	    0	
ulRejectCount:	    0	   38	    0	    0	    0	   38	    0	
ulValues:		    0	    0	   20	   20	   20	   20	    0	
fwType:		    4	    8	    2	    2	    2	    2	    1	
fwItemType:	    1	    1	    4	    4	    4	    4	    3	
ulMinimum:	    0	    0	    0	    0	    0	    0	    0	
usPhysicalIndex:	    7	    8	    0	    1	    2	    3	    5	
bManipulated:	    0	    0	    0	    0	    0	    0	    0	
bINOP:		    0	    0	    0	    0	    0	    0	    0	
bNotConfiged:	    0	    0	    0	    0	    0	    0	    0	
usCuINOP:	    0	    0	    0	    0	    0	    0	    0	
ulInterCashInCount:     0	    0	    0	    0	    0	    0	    0	
bNotUseDipswitch:	    0	    0	    0	    0	    0	    0	    0	
bExchange:	    1	    1	    0	    0	    0	    0	    1	
usNumOfNoteNumber:   18	   18	    3	    3	    3	    3	   18	
NoteNumbers:	[1]0[2]0[3]0[4]0[5]0[6]0[7]0[8]0[9]0[10]0[11]0[12]0[13]0[14]0[15]2[16]0[17]0[0]0	[1]0[2]0[3]0[4]0[5]0[6]0[7]0[8]0[9]0[10]0[11]0[12]0[13]0[14]0[15]32[16]0[17]0[0]6	[5]0[10]0[15]0	[5]0[10]0[15]0	[5]0[10]0[15]0	[5]0[10]0[15]0	[1]59[2]0[3]0[4]0[5]0[6]0[7]0[8]0[9]0[10]1[11]2[12]1[13]13[14]19[15]377[16]54[17]54[0]0	
20384294967295015400698183690003CDM0009FRAMEWORK00102022/12/07001220:36 11.9950011INFORMATION0032CBaseService::CheckStatusChanged0039Device Status Message Report.[Status=0]01544294967295015900698183700003CDM0009FRAMEWORK00102022/12/07001220:36 11.9950011INFORMATION0028CBaseService::BroadcastEvent0048hApp=0x00000000, pCursor->pData->hApp=0x2CE1849801594294967295013600698183710003CDM0009FRAMEWORK00102022/12/07001220:36 11.9950011INFORMATION0028CBaseService::BroadcastEvent0025pData->wClass=3, wClass=001364294967295015900698183720003CDM0009FRAMEWORK00102022/12/07001220:36 11.9950011INFORMATION0028CBaseService::BroadcastEvent0048hApp=0x2CE18498, pCursor->pData->hApp=0x2CE1B02801594294967295012600698183730003CDM0003SPI00102022/12/07001220:36 11.9950011INFORMATION0026CServiceAgent::ReportEvent0023call UnPack(0x1AA45530)01264294967295013700698183740003CDM0009FRAMEWORK00102022/12/07001220:36 11.9950011INFORMATION0028CBaseService::BroadcastEvent0026pData->wClass=13, wClass=001374294967295038400698183750003CDM0003SPI00102022/12/07001220:36 11.9950009XFS_EVENT0015SYSTEM_EVENT[4]0294WFS_SYSTEM_EVENT, 
lpResult =
{
	hWnd = [0x00030048],
	RequestID = [0],
	hService = [25],
	tsTimestamp = [2022/12/07 20:36 11.995],
	hResult = [0],
	u.dwEventID = [4],
	lpBuffer = [0x3133c8bc]
	{
		lpszPhysicalName = NULL,
		lpszWorkstationName = [********],
		dwState = [0]
	}
}03844294967295012600698183760003CIM0003SPI00102022/12/07001220:36 11.9950011INFORMATION0026CServiceAgent::ReportEvent0023call UnPack(0x1AA45580)01264294967295015900698183770003CDM0007ACTIVEX00102022/12/07001220:36 11.9950011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000417, wParam=0x1351EFD8, lParam=0x32CC54D401594294967295038400698183780003CIM0003SPI00102022/12/07001220:36 11.9950009XFS_EVENT0015SYSTEM_EVENT[4]0294WFS_SYSTEM_EVENT, 
lpResult =
{";
         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(sampleFile)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("54[0]0	\r\n"));
         Assert.IsTrue(logLine.Contains("NoteNumbers:"));
      }


      [TestMethod]
      public void DetectEOLNextLineStartsWithADigit()
      {
         // Test Sample Line
         string sampleFile =
            @"	ulRejectedCount4CIM(0) ulRetractedCount4CIM(0) ulTotalRetractedCount(0)
	ulRejectedCount4CDM(6) ulRetractedCount4CDM(0) ulRCretractcount(0)
22014294967295219700697922010003BRM0002SP00102022/12/07001219:21 23.5510011INFORMATION0026CBrmCommand::DumpTranInfos2095# Last TranInfos
usNumOfTranInfo : 8 
<1>
	ulValue(1) ulRemain(59) ulInitialCount(0)
	ulDispensedCount(0) ulCashInCount(59) ulTotalRejectedCount(0)
	ulRejectedCount4CIM(0) ulRetractedCount4CIM(0) ulTotalRetractedCount(0)
	ulRejectedCount4CDM(0) ulRetractedCount4CDM(0) ulRCretractcount(0)
<2>
	ulValue(2) ulRemain(0) ulInitialCount(0)
	ulDispensedCount(0) ulCashInCount(0) ulTotalRejectedCount(0)
	ulRejectedCount4CIM(0) ulRetractedCount4CIM(0) ulTotalRetractedCount(0)
	ulRejectedCount4CDM(0) ulRetractedCount4CDM(0) ulRCretractcount(0)
<3>";
         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(sampleFile)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("count(0)\r\n"));
      }


      [TestMethod]
      public void DetectEOLDontStopOnOpenAngleBrackets()
      {
         // Test Sample Line
         string sampleFile =
            @"21984294967295017200697960750003BRM0002SP00102022/12/07001219:28 34.3890011INFORMATION0026CBrmService::after_Execute0070<304> : Change the configuration of cassette from disable to enable(1)01724294967295050200697960760003BRM0002SP00102022/12/07001219:28 34.3890011INFORMATION0028CBrmCommand::DumpCstInopInfo0398# after_Execute : CstInopInfo
ulCstCount : 7 
<1> : <RTC> [0][0][0] (7) - [3][10] => [1][2][3]
<2> : <RJC> [0][0][0] (8) - [3][10] => [4][5][6]
<3> : <RC1> [0][0][0] (0) - [3][10] => [7][8][9]
<4> : <RC2> [0][0][0] (1) - [3][10] => [a][b][c]
<5> : <RC3> [0][0][0] (2) - [3][10] => [d][e][f]
<6> : <RC4> [0][0][0] (3) - [3][10] => [h][i][j]
<7> : <DPC> [0][0][0] (5) - [3][10] => [0][0][0]
05024294967295017100697960770013CashDispenser0009FRAMEWORK00102022/12/07001219:28 34.3890007DEVRETN0021CBaseService::Execute0061HSERVICE[14] COMMAND[304] HRESULT[-14] OUT BUFFER[0x00000000]01714294967295012300697960780006COMMON0009FRAMEWORK00102022/12/07001219:28 34.3890011INFORMATION0015CProcessor::Run0022---- Wait [14776] ----01234294967295030000697960790003CDM0003SPI00102022/12/07001219:28 34.3890009XFS_EVENT0012EXECUTE[304]0213WFS_EXECUTE_COMPLETE, 
lpResult =
{
	hWnd = [0x00030048],
	RequestID = [256108],
	hService = [14],
	tsTimestamp = [2022/12/07 19:28 34.389],
	hResult = [-14],
	u.dwCommandCode = [304],
	lpBuffer = NULL
}030042949672950159";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(sampleFile)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine(); 
         Assert.IsTrue(logLine.EndsWith("[0][0][0]\r\n"));
      }

      [TestMethod]
      public void DetectEOLRead2Lines()
      {
         // Test Sample Line
         string sampleFile =
            @"04004294967295019800698007020009INDICATOR0007ACTIVEX00102022/12/07001219:30 31.5500006XFSAPI0023CContextMgr::MgrWndProc0093WFS_SERVICE_EVENT(RequestID=0, hService=20, hResult=0, dwCommandCode=801 lpBuffer=0x3133C34C)01984294967295016500698007030009GUIDLIGHT0007ACTIVEX00102022/12/07001219:30 31.5500011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000415, wParam=0x1D27B720, lParam=0x2B6D2E2401654294967295012000698007040006COMMON0003SPI00102022/12/07001219:30 31.5500011INFORMATION0010WFPGetInfo0030HSERVICE=18, SrvcVersion=3(03)01204294967295023900698007050003SIU0003SPI00102022/12/07001219:30 31.5500007XFS_CMD0012GETINFO[801]0154hResult[0] = WFPGetInfo(
	hService = [18],
	dwCategory = [801],
	dwTimeOut = [0],
	hWnd = [0x0002028c],
	ReqID = [256268],
	lpQueryDetails = NULL
)02394294967295020300698007060009GUIDLIGHT0007ACTIVEX00102022/12/07001219:30 31.5510006XFSAPI0022CService::AsyncGetInfo0099WFSAsyncGetInfo(hService=18, dwCategory=801, lpQueryDetails=0x00000000, RequestID=256268) hResult=002034294967295016200698007070006SENSOR0007ACTIVEX00102022/12/07001219:30 31.5510011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000415, wParam=0x1D27B760, lParam=0x3251547401624294967295012000698007080006COMMON0003SPI00102022/12/07001219:30 31.5510011INFORMATION0010WFPGetInfo0030HSERVICE=19, SrvcVersion=3(03)01204294967295023900698007090003SIU0003SPI00102022/12/07001219:30 31.5510007XFS_CMD0012GETINFO[801]0154hResult[0] = WFPGetInfo(
	hService = [19],
	dwCategory = [801],
	dwTimeOut = [0],
	hWnd = [0x0002026a],
	ReqID = [256269],
	lpQueryDetails = NULL
)02394294967295020000698007100006SENSOR0007ACTIVEX00102022/12/07001219:30 31.5510006XFSAPI0022CService::AsyncGetInfo0099WFSAsyncGetInfo(hService=19, dwCategory=801, lpQueryDetails=0x00000000, RequestID=256269) hResult=002004294967295019800698007110009AUXILIARY0007ACTIVEX00102022/12/07001219:30 31.5520006XFSAPI0023CContextMgr::MgrWndProc0093WFS_SERVICE_EVENT(RequestID=0, hService=21, hResult=0, dwCommandCode=801 lpBuffer=0x3133CA3C)01984294967295016500698007120009INDICATOR0007ACTIVEX00102022/12/07001219:30 31.5520011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000415, wParam=0x1D27B640, lParam=0x32CC316401654294967295012000698007130006COMMON0003SPI00102022/12/07001219:30 31.5520011INFORMATION0010WFPGetInfo0030HSERVICE=20, SrvcVersion=3(03)01204294967295023900698007140003SIU0003SPI00102022/12/07001219:30 31.5520007XFS_CMD0012GETINFO[801]0154hResult[0] = WFPGetInfo(
	hService = [20],
	dwCategory = [801],";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(sampleFile)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith(" NULL\r\n)"));

         logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith(" NULL\r\n)"));
      }

      [TestMethod]
      public void DetectEOLNextCharIsSpace()
      {
         // Test Sample Line
         string sampleFile =
            @"03164294967295011700698019820006KEYMGR0003DLL00102022/12/07001219:31 11.2710006Normal00000042CPinPadCommand::SetDataBuffer2() szErr = .01174294967295009400698019830006KEYMGR0003DLL00102022/12/07001219:31 11.2710006NORMAL00000019OpenFDKDevice Start00944294967295009500698019840006KEYMGR0003DLL00102022/12/07001219:31 11.2710006NORMAL00000020OpenFDKDevice Start200954294967295009500698019850006KEYMGR0003DLL00102022/12/07001219:31 11.2710006NORMAL00000020OpenFDKDevice Start300954294967295011000698019860006KEYMGR0003DLL00102022/12/07001219:31 11.2710006Normal00000035CPinPadCommand::OpenDevice() Start.01104294967295011700698019870006KEYMGR0003DLL00102022/12/07001219:31 11.2710006Normal00000042CFunctionKeyDrv::OpenFuncKeyDevice() Start01174294967295012600698019880003BRM0003VDM00102022/12/07001219:31 11.3650003API0022BRM_ResetOperationMode0035BRM_SetConnectionInfo(0) [result=0]01264294967295012800698019890003BRM0002SP00102022/12/07001219:31 11.3650010NORMAL4VDM0030CSNRMappingTable::EnumRegistry0023dwCount [0] m_table[0] 01284294967295330300698019900003BRM0002SP00102022/12/07001219:31 11.3810010NORMAL4VDM0030CNHBRMProperty::CNHBRMProperty3198### Show Option ### 
 dwTraceLevel(2)
 dwP6Control(0)
 dwMaxAcceptCount(40)
 dwMaxDispenseCount(40)
 dwShutterControl4CDM(1)
 dwShutterControl4CIM(1)
 dwRecycleMode(0)
 dwReportExtraInfo(1)
 dwResetControl(0)
 dwConvPCU2LCU(2000F)
 dwCheckInvalidPosition(0)
 EPDownloadRetryCount(3)
 dwAutoReject(1)
 dwCuMove2RJIfCuEmpty(3)
 dwDaysToLeft(30)
 dwBCDaysToLeft(30)
 dwServiceVersion(320)
 dwHWErrorIfDeviceNotInPosition(2)
 dwMisfeedRetry(1)
 dwNumberOfRetractOperations(1)
 dwCheckInvalideCashUnit(0)
 dwP6Level2StackPosition(2048)
 dwCheckInvalidShutterStatus(0)
 dwDelBinFileWhenDowngrade(1)
 dwCuOKIfMANIP4RTRJ(1)
 dwCashInCloseShutterIfOpened(1)
 dwErrorCodeIfDeviceOnline(0)
 dwRtToRjcIfBinFull(0)
 dwDispenseType(1)
 dwForceRollBackIfPosNotEmpty(1)
 dwStatus4AcceptorDispenser(1)
 dwulRejectCount4RJCU(1)
 dwIgnoreTransaction4Reset(1)
 dwConfigDispense(0)
 dwCuMANIPIfPCUMiss(0)
 dwDispCuStopIfCountZero(0)
 dwClearExtraCountIfCountZero(1)
 dwSeperateDispenseReady(0)
 dwIgnoreCashInActive(1)
 dwA2iARecog(0)
 dwTimeoutForA2iARecog(60000)
 dwStatusPollingTime(50)
 dwIgnoreSkew4CashIn(1)
 dwBetterNoteInfoThanErrRate(1)
 dwAccStopIfTypeAllNotAvail(1)
 dwEnableChangeCashUnitInfo(0)
 dwSerialNumber(0)
 dwRegister4SerialNumber(0)
 dwControlOverlapSerialNumber(1118481)
 dwStackPos4AbnormalSerialNo(0)
 dwNoteSerialImage(0)
 dwSerialNumberDaysToLeft(30)
 dwCloseShutterIfOpened(0)
 dwEnableVDM4Serial(0)
 dwCompoundOptions(0)
 dwEnableSubDispense(0)
 dwSubDispenseItemTakenTime(30000)
 dwSetHighIfNotDetectFullSensor4RT(1)
 dwP6ControlWhenRetract(0)
 dwControl4FailedReadSN(0)
 ReplaceChar4FailedReadSN(*)
 AttemptCount4CSMRT(0)
 EnableSerialImageToJPG(0)
 dwL1NotesPosIfRetract2RC(0)
 dwLow2OkIfBinLow(1)
 dwFullHigh2OkIfBinFullHigh(1)
 dwHandleEpRetractNotes(1)
 dwSleep4CashInIfAutoShutter(1)
 dwAddSerialInfo4INIFile(0)
 dwSaveSerialInfo4INIFile(0)
 dwDisableIdleCheck(3)
 dwSkewDetectionTime(0)
 dwShutterOpenCheck(0)
 dwHWErrorIfCloseFail(0)
 dwCashInCancel(1)
 dwUseSnMdb(0)
 dwDisableCimCstEvent(0)
 dwCashInTooManyItems(0)
 dwDualShutterStatusOpen(0)
 dwDisLowStatus(0)
 dwReverseDotMatrix(0)
 dwSaveFsnFile(0)
 dwFSNDaysToLeft(-1)
 dwChangeAcceptorWhenError(1)
 dwIsWaitForCashTaken(0)
 dwUseRecycleUnitWhenCashIn(1)
 dwDefaultMixAlgorithm(0)
 dwMakePCUStatusFromLCU(1)
 ShutterControl4CIM(CashIn[0], RollBack[0], dwUpdateUnknownNoteToRefused[0], dwPCUMinimum[0])
 dwCstRotation(0)
 dwRjToCashInIfBinFull(0)
 dwUseCstAccounts(0)
 dwUseShutterJammed(0)
 dwMixMode(1)
 dwUseDeviceStatusBusy(0)
 dwCheckHandSensorWhenInsert(0)
 dwAccOKIfRJFull(1)
 dwDisableTERejectButton(0)
 dwNoCstChangedEventWhenTest(0)
 dwCreateCstOptionIfMissing(1)
 dwNotSaveFsnIfError(0)
 dwUseSystemInfo(1)
 dwShutterOpenCheckValue(0)
 dwShutterLockCheckInPresent (1)
 dwSaveP6NoteSerialImage(0)
 dwReportExtraInfoEx(0)
 dwCuLowIfDispensableLow(0)
 dwReportFullHighToOK(1)
 dwClearInopWhenEndExchange(0)
dwCstOperMode(0)
 dwForceWriteCstID(0)
 dwSetCount4DPC(1)
 dwCheckInitCount(1)
dwCheckTEStatusWhenCount(0)
 dwSaveUKNoteImage(0)
 dwShutterCloseIfOutShutterFail(0)
dwEnableRealAcceptCount(0)
33034294967295076600698019910003BRM0002SP00102022/12/07001219:31 11.3810010NORMAL4VDM0030CNHBRMProperty::CNHBRMProperty0661### Directory ### 
ConfigDir(C:\Hyosung\Nextware\Exe) LogDir(C:\Hyosung\Nextware\Trace\EPLOG\BC_REJECT) DispInfoDir(C:\Hyosung\Nextware\Exe\) EPDownloadDir(C:\Hyosung\Nextware\Exe) 
";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(sampleFile)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("dwEnableRealAcceptCount(0)\r\n"));
      }

      [TestMethod]
      public void DetectEOLTableDataIncludesDash()
      {
         // Test Sample Line
         string sampleFile =
            @"03284294967295011200698021500005CSM500002SP00102022/12/07001219:31 12.2730006NORMAL0021CNHUsb2::ReadPrevData0018Bulk Length: 4409601124294967295013400698021510003SPR0002SP00102022/12/07001219:31 12.2730006Normal0028CNHPTR4SPRDev::CNHPTR4SPRDev0035[NHSpCom] support TraceErrHistory!!01344294967295011200698021520005CSM500002SP00102022/12/07001219:31 12.2730006NORMAL0021CNHUsb2::ReadPrevData0018Data Length: 4403501124294967295011400698021530003SPR0002SP00102022/12/07001219:31 12.2730006NORMAL0025KSPRProperty::ShowOptions0018# DeviceName=LSPR301144294967295014600698021540003SPR0002SP00102022/12/07001219:31 12.2730006NORMAL0025KSPRProperty::ShowOptions0050# DLLName=NHUSBDevCommDLL20.dll, DriverName=nh SPR01464294967295168000698021550003SPR0002SP00102022/12/07001219:31 12.2830006NORMAL0025KSPRProperty::ShowOptions1584# REGISTRY OPTIONS
Name            Value         Function
------------------------------------
TraceLevel      0x00000001
FontFileName    
PrintImageName1 C:\Hyosung\Nextware\Trace\PrinterBack.bmp
PrintImageName2 C:\Hyosung\Nextware\Trace\PrinterBack.bmp
DefaultFont     Lucida Console
EPDirectory     C:\Hyosung\Nextware\EXE
------------------------------------
Initialize      0x00000000
TopMargin       0x00000000
PaperSize       0x00000065
TotalColumn     0x00000028
CutMargin       0x000000a0
LeftMargin      0x00000003
ImageNumber     0x00000001
PrintOption     0x00000000
SelectBackground 0x00000001
LineSpace        0x00000008
EPDownloadOption 0x00000002
DefaultPointSize 0x0000000a
DownloadRetryCount 0x00000001
EPDefaultFontID  99
FontHeight       0x0000001a
------------------------------------
ErrorCode7D      0x00000001
FontDownload     0x00000000
ImageDownloadOn  0x00000000
SelectFont       0x00000000
SetConf          0x00000001
LowSensor        0x00000001
JamSensor        0x00000000
MediaTaken       0x00000001
Unicode          0x00000001
EnLandscape      0x00000000
MBSupport        0x00000000
MultibyteCharSet 0x00000000
EPSupportMultibyte 0x00000001
Text2Image       0x00000001
IsHWErrorWhenPaperOut 0
BufferedPrint    0
BitmapAddSpace    1
BitmapSpaceHeight    10
ExtraFieldUse    1
TecbanConvAscii    0
bIsAsyncEPDownload	0
bDetectPaperAfterAutoload 1
EPLogFilePath C:\Hyosung\Nextware\Trace\EPLOG
EPLogFileBackUpPath C:\Hyosung\Nextware\BACKUPNHY
EPLogDaysToLeft	 30
EPLogDaysToBackup	 5
UseTakenSensor	 0
16804294967295011300698021560003SPR0002SP00102022/12/07001219:31 12.2830006NORMAL0026CNHPTR4SPRDev::FindSPRType0016SPR Type : LSPR301134294967295012400698021570006COMMON0002SP00102022/12/07001219:31 12.2830006NORMAL0010LoadRegDll0040Success to LoadLibrary NHRegUtils.dll!!!01244294967295013700698021580003SPR0002SP00102022/12/07001219:31 12.2830011INFORMATION0046CDeviceControlWrapper::CDeviceControlWrapper()0015UseUSBReset : 101374294967295018000698021590003SPR0002SP00102022/12/07001219:31 12.2830006NORMAL0044CDeviceControlWrapper::CDeviceControlWrapper0065[NHUSBDevComm20.dll][V02.00.04.01][Hyosung USB communication DLL]01804294967295014200698021600003SPR0002SP00102022/12/07001219:31 12.2830011INFORMATION0046CDeviceControlWrapper::CDeviceControlWrapper()0020m_nUSBResetTime : 1001424294967295014200698021610003SPR0002SP00102022/12/07001219:31 12.2830011INFORMATION0046CDeviceControlWrapper::CDeviceControlWrapper()0020m_nUSBResetCount : 301424294967295014800698021620003SPR0002SP00102022/12/07001219:31 12.2930011INFORMATION0046CDeviceControlWrapper::CDeviceControlWrapper()0026m_nEPUsbResetintervalC : 101484294967295014800698021630003SPR0002SP00102022/12/07001219:31 12.2930011INFORMATION0046CDeviceControlWrapper::CDeviceControlWrapper()0026m_nEPUsbResetintervalA : 101484294967295011500698021640003SPR0002SP00102022/12/07001219:31 12.2930006NORMAL0025CNHPTR4SPRDev::DeviceOpen0019DeviceOpen Invoked.01154294967295010700698021650003DLL0006nh SPR00102022/12/07001219:31 12.2930006INFORM0013CUSB::Connect0019m_szDevName[nh SPR]01074294967295019600698021660003DLL0006nh SPR00102022/12/07001219:31 12.2930011INFORMATION0019CUSB::OpenOneDevice0097Attempting to open \\?\usb#vid_1a75&pid_1153#6&9c9e90&0&4#{25d9c40f-65fc-4afc-89dd-7484e99290f2}
0196429496";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(sampleFile)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("UseTakenSensor	 0\r\n"));
      }

      [TestMethod]
      public void DetectEOLAnotherFormofTable()
      {
         // Test Sample Line
         string sampleFile =
            @"00 00 00 03164294967295013300698042420003SPR0002SP00102022/12/07001219:37 44.1620011INFORMATION0038CDeviceControlWrapper::OnPositiveReply0019OnPositiveReply !!!01334294967295011400698042430003SPR0002SP00102022/12/07001219:37 44.1620006NORMAL0025CNHPTR4SPRDev::DeviceOpen0018[0] = DeviceOpen()01144294967295018100698042440003SPR0002SP00102022/12/07001219:37 52.2720011INFORMATION0035CDeviceControlWrapper::UpdateSensor0070##iCheckLog Start SENSOR_DATA Unit: SPR, Message: C300 iCheckLog End##01814294967295041600698042450003SPR0002SP00102022/12/07001219:37 52.2720011INFORMATION0035CDeviceControlWrapper::UpdateSensor0305## S1 : SENSOR STATUS1
Bit Off/On Function
------------------------------------
0   On     Paper Not End.
1   On     Black Mark.
2   Off     Jam.
3   Off     Cutter.
4   Off     Head Not open.
5   Off     TPH.
6   On     Paper Not Out.
7   On     DIPS/W2.
------------------------------------
04164294967295042200698042460003SPR0002SP00102022/12/07001219:37 52.2720011INFORMATION0035CDeviceControlWrapper::UpdateSensor0311## S2 : SENSOR STATUS2
Bit Off/On Function
------------------------------------";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(sampleFile)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("------------------------------------\r\n"));
      }

      [TestMethod]
      public void DetectEOLReadMultipleLines()
      {
         // Test Sample Line
         string sampleFile =
            @"	u.dwCommandCode = [407],
	lpBuffer = [0x30fe083c]
}03064294967295020000698133780003PIN0007ACTIVEX00102022/12/07001220:35 12.9560006XFSAPI0023CContextMgr::MgrWndProc0101WFS_EXECUTE_COMPLETE(RequestID=256477, hService=24, hResult=0, dwCommandCode=407 lpBuffer=0x30FE083C)02004294967295015900698133790003PIN0007ACTIVEX00102022/12/07001220:35 12.9560011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000408, wParam=0x00000000, lParam=0x2B6D6DFC01594294967295012200698133800003PIN0007ACTIVEX00102022/12/07001220:35 12.9570005EVENT0027CPINService::HandlePinBlock0020FirePinBlockComplete01224294967295011800698133810009GUIDLIGHT0007ACTIVEX00102022/12/07001220:35 12.9620008PROPERTY0018Ctrl::GetHasPinPad0016HasPinPad[FALSE]01184294967295014000698133820006SENSOR0007ACTIVEX00102022/12/07001220:35 12.9870008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133830006SENSOR0007ACTIVEX00102022/12/07001220:35 12.9880008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133840006SENSOR0007ACTIVEX00102022/12/07001220:35 13.0030008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133850006SENSOR0007ACTIVEX00102022/12/07001220:35 13.0050008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133860006SENSOR0007ACTIVEX00102022/12/07001220:35 13.0150008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133870006SENSOR0007ACTIVEX00102022/12/07001220:35 13.0170008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133880006SENSOR0007ACTIVEX00102022/12/07001220:35 13.0260008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133890006SENSOR0007ACTIVEX00102022/12/07001220:35 13.0260008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133900006SENSOR0007ACTIVEX00102022/12/07001220:35 13.0340008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133910006SENSOR0007ACTIVEX00102022/12/07001220:35 13.0340008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133920006SENSOR0007ACTIVEX00102022/12/07001220:35 13.0450008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133930006SENSOR0007ACTIVEX00102022/12/07001220:35 13.0450008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133940006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1120008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133950006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1120008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133960006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1180008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698133970006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1180008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295011900698133980003IDC0007ACTIVEX00102022/12/07001220:35 13.1480008PROPERTY0020Ctrl::GetMediaStatus0021MediaStatus = PRESENT01194294967295014000698133990006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1530008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698134000006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1530008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698134010006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1540008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698134020006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1550008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698134030006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1550008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698134040006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1550008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698134050006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1730008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698134060006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1740008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698134070006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1750008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698134080006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1750008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295011900698134090003CIM0007ACTIVEX00102022/12/07001220:35 13.1940008PROPERTY0023Ctrl::GetMaxStackerItem0018MaxStackerItem[40]01194294967295014000698134100006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1960008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698134110006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1970008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698134120006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1980008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295014000698134130006SENSOR0007ACTIVEX00102022/12/07001220:35 13.1980008PROPERTY0028Ctrl::GetEnhancedAudioStatus0031EnhancedAudioStatus[NOTPRESENT]01404294967295013400698134140003IDC0007ACTIVEX00102022/12/07001220:35 13.2750006METHOD0012Ctrl::ChipIO0046Invoked {Protocol[0], Token[SEND], Timeout[0]}01344294967295011500698134150003IDC0007ACTIVEX00102022/12/07001220:35 13.2760011INFORMATION0012Ctrl::ChipIO0022ARRAY TYPE[0x0000200c]01154294967295011800698134160006COMMON0003SPI00102022/12/07001220:35 13.2760011INFORMATION0010WFPExecute0028HSERVICE=27, SrvcVersion=3.001184294967295013700698134170006COMMON0003SPI00102022/12/07001220:35 13.2770011INFORMATION0010WFPExecute0047COMMAND=209, XFS30[30FCCA2C] -> XFS31[30FCCA2C]01374294967295021800698134180006COMMON0009FRAMEWORK00102022/12/07001220:35 13.2770011INFORMATION0033CSpCmdDispatcher::DispatchCommand0099m_pCmdQ->Insert() {HSERVICE[27], HWND[0x00010390], REQUESTID[256478], dwCmdCode[209], dwTimeOut[0]}02184294967295024100698134190003IDC0003SPI00102022/12/07001220:35 13.2770007XFS_CMD0012EXECUTE[209]0156hResult[0] = WFPExecute(
	hService = [27],
	dwCommand = [209],
	dwTimeOut = [0],
	hWnd = [0x00010390],
	ReqID = [256478],
	lpCmdData = [0x30fcca2c]
)02414294967295019200698134200006COMMON0009FRAMEWORK00102022/12/07001220:35 13.2780011INFORMATION0025CCommandQueue::RemoveHead0081return (bResult[1]) pCommand{hService[27],..., ReqID[256478], dwCommandCode[209]}01924294967295018200698134210003IDC0007ACTIVEX00102022/12/07001220:35 13.2780006XFSAPI0017CService::Execute0089WFSAsyncExecute(hService=27, dwCommand=209, lpCmdData=0x30FCCA2C, ReqID=256478) hResult=001824294967295012200698134220006COMMON0009FRAMEWORK00102022/12/07001220:35 13.2780011INFORMATION0015CProcessor::Run0021Execute{hService[27]}01224294967295016400698134230006COMMON0009FRAMEWORK00102022/12/07001220:35 13.2790011INFORMATION0028CServiceProvider::GetService0050service OK {HSERVICE[27], LogicalName[CardReader]}01644294967295015400698134240010CardReader0009FRAMEWORK00102022/12/07001220:35 13.2790007DEVCALL0021CBaseService::Execute0047HSERVICE[27] COMMAND[209] IN BUFFER[0x0067B0E4]01544294967295010700698134250003IDC0009FRAMEWORK00102022/12/07001220:35 13.2790007DEVCALL0019CIdcService::ChipIO0009GetStatus01074294967295011100698134260003IDC0009FRAMEWORK00102022/12/07001220:35 13.2790007DEVCALL0019CIdcService::ChipIO0013ProcessChipIO01114294967295010900698134270003IDC0002SP00102022/12/07001220:35 13.2790006Normal0033CNHDIP4SANDIPDev::ProcessChipIO()0005Start01094294967295014400698134280003IDC0002SP00102022/12/07001220:35 13.2880006Normal0033CNHDIP4SANDIPDev::ProcessChipIO()0040ChipProtocol = (HEX)1, ChipInLength = 4901444294967295016200698134290003IDC0002SP00102022/12/07001220:35 13.2890006NORMAL0039CSankyoUSBDLLWrapper::EncICCardTransmit0052EncICCardTransmit(lpszSerialNumber=E1070209) Invoked01624294967295012100698134300003IDC0002SP00102022/12/07001220:35 13.4080006Normal0033CNHDIP4SANDIPDev::ProcessChipIO()0017Chip IO data sent01214294967295014500698134310003IDC0002SP00102022/12/07001220:35 13.4100006Normal0033CNHDIP4SANDIPDev::ProcessChipIO()0041ChipProtocol = (HEX)1, ChipOutLength = 4501454294967295010800698134320003IDC0002SP00102022/12/07001220:35 13.4110006Normal0033CNHDIP4SANDIPDev::ProcessChipIO()0004End 01084294967295016600698134330010CardReader0009FRAMEWORK00102022/12/07001220:35 13.4120007DEVRETN0021CBaseService::Execute0059HSERVICE[27] COMMAND[209] HRESULT[0] OUT BUFFER[0x0067AFC4]01664294967295012300698134340006COMMON0009FRAMEWORK00102022/12/07001220:35 13.4130011INFORMATION0015CProcessor::Run0022---- Wait [14880] ----01234294967295030600698134350003IDC0003SPI00102022/12/07001220:35 13.4130009XFS_EVENT0012EXECUTE[209]0219WFS_EXECUTE_COMPLETE, 
lpResult =
{
	hWnd = [0x00010390],
	RequestID = [256478],
	hService = [27],
	tsTimestamp = [2022/12/07 20:35 13.412],
	hResult = [0],
	u.dwCommandCode = [209],
	lpBuffer = [0x30fcca2c]
}03064294967295020000698134360003IDC0007ACTIVEX00102022/12/07001220:35 13.4250006XFSAPI0023CContextMgr::MgrWndProc0101WFS_EXECUTE_COMPLETE(RequestID=256478, hService=27, hResult=0, dwCommandCode=209 lpBuffer=0x30FCCA2C)02004294967295015900698134370003IDC0007ACTIVEX00102022/12/07001220:35 13.4260011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000408, wParam=0x00000000, lParam=0x32515CE401594294967295012000698134380006COMMON0003SPI00102022/12/07001220:35 13.4270011INFORMATION0010WFPGetInfo0030HSERVICE=27, SrvcVersion=3(03)01204294967295024400698134390003IDC0003SPI00102022/12/07001220:35 13.4270007XFS_CMD0012GETINFO[201]0159hResult[0] = WFPGetInfo(
	hService = [27],
	dwCategory = [201],
	dwTimeOut = [300000],
	hWnd = [0x00010390],
	ReqID = [256479],
	lpQueryDetails = NULL
)02444294967295022500698134400006COMMON0009FRAMEWORK00102022/12/07001220:35 13.4270011INFORMATION0033CSpCmdDispatcher::DispatchCommand0106pService->GetInfo() {HSERVICE[27], HWND[0x00010390], REQUESTID[256479], dwCmdCode[201], dwTimeOut[300000]}02254294967295019200698134410003IDC0007ACTIVEX00102022/12/07001220:35 13.4280006XFSAPI0017CService::GetInfo0099WFSAsyncGetInfo(hService=27, dwCategory=201, lpQueryDetails=0x00000000, RequestID=256479) hResult=001924294967295016400698134420006COMMON0009FRAMEWORK00102022/12/07001220:35 13.4280011INFORMATION0028CServiceProvider::GetService0050service OK {HSERVICE[27], LogicalName[CardReader]}01644294967295016800698134430003IDC0009FRAMEWORK00102022/12/07001220:35 13.4280011INFORMATION0021CBaseService::GetInfo0064Srvc=201 ReqID=256479 Wnd=0x00010390 Cmd=201 TimeOut=300000 IO=101684294967295015500698134440010CardReader0009FRAMEWORK00102022/12/07001220:35 13.4290007DEVCALL0021CBaseService::GetInfo0048HSERVICE[27] CATEGORY[201] IN BUFFER[0x00000000]01554294967295010700698134450003IDC0009FRAMEWORK00102022/12/07001220:35 13.4290007DEVCALL0019CIdcService::Status0009GetStatus01074294967295016800698134460010CardReader0009FRAMEWORK00102022/12/07001220:35 13.4290007DEVRETN0021CBaseService::GetInfo0061HSERVICE[27] CATEGORY[201] HRESULT[0], OUT BUFFER[0x006943E4]01684294967295128500698134470003IDC0003SPI00102022/12/07001220:35 13.4300009XFS_EVENT0012GETINFO[201]1198WFS_GETINFO_COMPLETE, 
lpResult =
{
	hWnd = [0x00010390],
	RequestID = [256479],
	hService = [27],
	tsTimestamp = [2022/12/07 20:35 13.430],
	hResult = [0],
	u.dwCommandCode = [201],
	lpBuffer = [0x31212c8c]";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(sampleFile)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("[0x30fe083c]\r\n}"));

         logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("[0x30fcca2c]\r\n)"));

         logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("[0x30fcca2c]\r\n}"));

         logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("lpQueryDetails = NULL\r\n)"));
      }

      
      [TestMethod]
      public void Find_WFS_INF_CDM_STATUS()
      {
         string nwLogLine =
@"16144294967295016600087401140006COMMON0009FRAMEWORK00102023/01/24001200:59 14.6560011INFORMATION0028CServiceProvider::GetService0052service OK {HSERVICE[2], LogicalName[CashDispenser]}01664294967295016300087401150003CDM0007ACTIVEX00102023/01/24001200:59 14.6560011INFORMATION0024CContextMgr::SetComplete0058SetComplete(Waiting ReqID=[17611], Arrival ReqID=[17610]) 01634294967295015900087401160003CDM0007ACTIVEX00102023/01/24001200:59 14.6560011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000407, wParam=0x080B2C58, lParam=0x0C60CF7401594294967295016700087401170003CDM0009FRAMEWORK00102023/01/24001200:59 14.6570011INFORMATION0021CBaseService::GetInfo0063Srvc=301 ReqID=17611 Wnd=0x0002019C Cmd=301 TimeOut=300000 IO=101674294967295019300087401180003CDM0007ACTIVEX00102023/01/24001200:59 14.6570011INFORMATION0024CContextMgr::SetComplete0088SetComplete(Waiting ReqID=[17610], Arrival ReqID=[17610]), Remove ReqID[17610] from List01934294967295016800087401190003CDM0007ACTIVEX00102023/01/24001200:59 14.6570011INFORMATION0031CCdmService::HandleCashUnitInfo0056GetInfo-Result[CashUnitInfo][ReqID=17612] = {hResult[0]}01684294967295015700087401200013CashDispenser0009FRAMEWORK00102023/01/24001200:59 14.6570007DEVCALL0021CBaseService::GetInfo0047HSERVICE[2] CATEGORY[301] IN BUFFER[0x00000000]01574294967295016300087401210003CDM0007ACTIVEX00102023/01/24001200:59 14.6570011INFORMATION0024CContextMgr::SetComplete0058SetComplete(Waiting ReqID=[17613], Arrival ReqID=[17612]) 01634294967295017000087401220013CashDispenser0009FRAMEWORK00102023/01/24001200:59 14.6570007DEVRETN0021CBaseService::GetInfo0060HSERVICE[2] CATEGORY[301] HRESULT[0], OUT BUFFER[0x014D488C]01704294967295019300087401230003CDM0007ACTIVEX00102023/01/24001200:59 14.6570011INFORMATION0024CContextMgr::SetComplete0088SetComplete(Waiting ReqID=[17612], Arrival ReqID=[17612]), Remove ReqID[17612] from List01934294967295022500087401240006COMMON0009FRAMEWORK00102023/01/24001200:59 14.6580011INFORMATION0033CSpCmdDispatcher::DispatchCommand0106pService->GetInfo() {HSERVICE[12], HWND[0x000201a0], REQUESTID[17614], dwCmdCode[1303], dwTimeOut[300000]}02254294967295141100087401250003CDM0003SPI00102023/01/24001200:59 14.6580009XFS_EVENT0012GETINFO[301]1324WFS_GETINFO_COMPLETE, 
lpResult =
{
	hWnd = [0x0002019c],
	RequestID = [17611],
	hService = [2],
	tsTimestamp = [2023/01/24 00:59 14.658],
	hResult = [0],
	u.dwCommandCode = [301],
	lpBuffer = [0x78aa97b4]
	{
		fwDevice = [0],
		fwSafeDoor = [1],
		fwDispenser = [0],
		fwIntermediateStacker = [0],
		lppPositions =
		{
			fwPosition = [4],
			fwShutter = [0],
			fwPositionStatus = [0],
			fwTransport = [0],
			fwTransportStatus = [0]
		}
		lpszExtra = [BCMode=REAL-NOTE,BRM20SensorInfo=[1][4][5][0][0][0][0][0][2][2][2][2][2][1][1][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][3][1][1][1][1][1][1][1][4][3][3][4][3][3][0][0][3][0][0][3][3][4][0][0][6][6][6][0][0][0][3][0][1][0][0][0][0][0][0][0][...],
		dwGuidLights =
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000]
		wDevicePosition = [0],
		usPowerSaveRecoveryTime = [0],
		wAntiFraudModule = [0]
	}
}14114294967295018900087401260007MONIMNG0008XFSAGENT00102023/01/24001200:59 14.6580004INFO0026Agent::ProcessNotification0084Recv WFS_SYSTEM_EVENT Event(ManagedName=[CashDispenser] hService=[28] dwEventID=[4])01894294967295016600087401270006COMMON0009FRAMEWORK00102023/01/24001200:59 14.6580011INFORMATION0028CServiceProvider::GetService0052service OK {HSERVICE[12],";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(nwLogLine)));

         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("wAntiFraudModule = [0]\r\n\t}\r\n}"));
      }

      [TestMethod]
      public void Find_WFS_INF_CDM_CASH_UNIT_INFO()
      {
         Assert.IsTrue(true); 
      }

      [TestMethod]
      public void Find_WFS_CMD_CDM_DISPENSE()
      {
         string nwLogLine =
@"03824294967295016800090644770013CashDispenser0009FRAMEWORK00102023/01/24001221:44 44.8060007DEVRETN0021CBaseService::Execute0058HSERVICE[2] COMMAND[302] HRESULT[0] OUT BUFFER[0x0150F53C]01684294967295015900090644780003CDM0009FRAMEWORK00102023/01/24001221:44 44.8060011INFORMATION0028CBaseService::BroadcastEvent0048hApp=0x0E770CEA, pCursor->pData->hApp=0x0E770CEA01594294967295012600090644790003CIM0003SPI00102023/01/24001221:44 44.8060011INFORMATION0026CServiceAgent::ReportEvent0023call UnPack(0x05AF4C20)01264294967295015900090644800003CDM0007ACTIVEX00102023/01/24001221:44 44.8060011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000417, wParam=0x00EB3888, lParam=0x0706AD4401594294967295012200090644810006COMMON0009FRAMEWORK00102023/01/24001221:44 44.8070011INFORMATION0015CProcessor::Run0021---- Wait [2148] ----01224294967295042800090644820003CDM0003SPI00102023/01/24001221:44 44.8070009XFS_EVENT0012EXECUTE[302]0341WFS_EXECUTE_COMPLETE, 
lpResult =
{
	hWnd = [0x000301f8],
	RequestID = [9684],
	hService = [2],
	tsTimestamp = [2023/01/24 21:44 44.807],
	hResult = [0],
	u.dwCommandCode = [302],
	lpBuffer = [0x2544e504]
	{
		cCurrencyID = [USD],
		ulAmount = [20],
		usCount = [6],
		lpulValues = [0, 0, 0, 0, 1, 0],
		ulCashBox = [0]
	}
}04284294967295013600090644830003CDM0009FRAMEWORK00102023/01/24001221:44 44.8070011INFORMATION0028CBaseService::BroadcastEvent0025pData->wClass=3, wClass=001364294967295038200090644840003CIM0003SPI00102023/01/24001221:44 44.8070009XFS_EVENT0015SYSTEM_EVENT[4]0292WFS_SYSTEM_EVENT, 
lpResult =
{
	hWnd = [0x000206f8],
	RequestID = [0],
	hService = [27],
	tsTimestamp = [2023/01/24 21:44 44.802],
	hResult = [0],
	u.dwEventID = [4],
	lpBuffer = [0x007a1384]
	{
		lpszPhysicalName = NULL,
		lpszWorkstationName = [******],
		dwState = [0]
	}
}038242949672950";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(nwLogLine)));

         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("ulCashBox = [0]\r\n\t}\r\n}"));
      }

      [TestMethod]
      public void Find_WFS_CMD_CDM_PRESENT()
      {
         string nwLogLine =
@"05024294967295015800090652300013CashDispenser0009FRAMEWORK00102023/01/24001221:44 48.0270007DEVCALL0021CBaseService::GetInfo0048HSERVICE[17] CATEGORY[309] IN BUFFER[0x1F7E62B4]01584294967295016100090652310003CDM0007ACTIVEX00102023/01/24001221:44 48.0270011INFORMATION0024CContextMgr::SetComplete0056SetComplete(Waiting ReqID=[9734], Arrival ReqID=[9733]) 01614294967295012500090652320003BRM0002SP00102023/01/24001221:44 48.0280011INFORMATION0025CBrmCommand::UpdateStatus0024IdleStatus changed[0->1]01254294967295016800090652330013CashDispenser0009FRAMEWORK00102023/01/24001221:44 48.0280007DEVRETN0021CBaseService::Execute0058HSERVICE[2] COMMAND[303] HRESULT[0] OUT BUFFER[0x00000000]01684294967295012900090652340003BRM0002SP00102023/01/24001221:44 48.0280011INFORMATION0010BRM2XFSCDM0043(lpBrmPresentStatus[[0][0][0][0][1][0][0]])01294294967295019000090652350003CDM0007ACTIVEX00102023/01/24001221:44 48.0280011INFORMATION0024CContextMgr::SetComplete0085SetComplete(Waiting ReqID=[9733], Arrival ReqID=[9733]), Remove ReqID[9733] from List01904294967295012200090652360006COMMON0009FRAMEWORK00102023/01/24001221:44 48.0290011INFORMATION0015CProcessor::Run0021---- Wait [2148] ----01224294967295029500090652370003CDM0003SPI00102023/01/24001221:44 48.0290009XFS_EVENT0012EXECUTE[303]0208WFS_EXECUTE_COMPLETE, 
lpResult =
{
	hWnd = [0x000301f8],
	RequestID = [9720],
	hService = [2],
	tsTimestamp = [2023/01/24 21:44 48.029],
	hResult = [0],
	u.dwCommandCode = [303],
	lpBuffer = NULL
}02954294967295014900090652380003BRM0002SP00102023/01/24001221:44 48.0290011INFORMATION0019CMonitorThread::Run0054m_oldBrmStatus.fwIntermediateStacker4CDM changed(1->0)01494294967295017100090652390013CashDispenser0009FRAMEWORK00102023/01/24001221:44 48.0300007DEVRETN0021CBaseService::GetInfo0061HSERVICE[17] CATEGORY[309] HRESULT[0], OUT BUFFER[0x014FA574]01714294967295015900090652400003CDM0007ACTIVEX00102023/01/24001221:44 ";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(nwLogLine)));

         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("lpBuffer = NULL\r\n}"));
      }

      [TestMethod]
      public void Find_WFS_CMD_CDM_REJECT()
      {
         string nwLogLine =
@"02364294967295018800001839360006COMMON0009FRAMEWORK00102022/06/06001205:18 10.4340011INFORMATION0025CCommandQueue::RemoveHead0077return (bResult[1]) pCommand{hService[2],..., ReqID[158], dwCommandCode[304]}01884294967295017800001839370003CDM0007ACTIVEX00102022/06/06001205:18 10.4340006XFSAPI0017CService::Execute0085WFSAsyncExecute(hService=2, dwCommand=304, lpCmdData=0x00000000, ReqID=158) hResult=001784294967295012100001839380006COMMON0009FRAMEWORK00102022/06/06001205:18 10.4350011INFORMATION0015CProcessor::Run0020Execute{hService[2]}01214294967295016600001839390006COMMON0009FRAMEWORK00102022/06/06001205:18 10.4370011INFORMATION0028CServiceProvider::GetService0052service OK {HSERVICE[2], LogicalName[CashDispenser]}01664294967295015600001839400013CashDispenser0009FRAMEWORK00102022/06/06001205:18 10.4380007DEVCALL0021CBaseService::Execute0046HSERVICE[2] COMMAND[304] IN BUFFER[0x00000000]01564294967295011100001839410003CDM0009FRAMEWORK00102022/06/06001205:18 10.4400007DEVCALL0026CCdmService::ExecuteReject0006Reject01114294967295013000001839420003CDM0009FRAMEWORK00102022/06/06001205:18 10.4420005ERROR0026CCdmService::ExecuteReject0027Reject Fail! ==> LINE = -5001304294967295013500001839430003CDM0009FRAMEWORK00102022/06/06001205:18 10.4430011INFORMATION0020CCdmService::Execute0032WFS_CMD_CDM_REJECT{hResult[-50]}01354294967295017000001839440013CashDispenser0009FRAMEWORK00102022/06/06001205:18 10.4430007DEVRETN0021CBaseService::Execute0060HSERVICE[2] COMMAND[304] HRESULT[-50] OUT BUFFER[0x00000000]01704294967295012200001839450006COMMON0009FRAMEWORK00102022/06/06001205:18 10.4440011INFORMATION0015CProcessor::Run0021---- Wait [4996] ----01224294967295029600001839460003CDM0003SPI00102022/06/06001205:18 10.4440009XFS_EVENT0012EXECUTE[304]0209WFS_EXECUTE_COMPLETE, 
lpResult =
{
	hWnd = [0x000200c4],
	RequestID = [158],
	hService = [2],
	tsTimestamp = [2022/06/06 05:18 10.444],
	hResult = [-50],
	u.dwCommandCode = [304],
	lpBuffer = NULL
}02964294967295015900001839470003CDM0007ACTIVEX00102022/06/06001205:18 10.4460011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000408, wParam=0x00000000, lParam=0x19AD222401594294967295011900001839480006COMMON0003SPI00102022/06/06001205:18 10.4460011INFORMATION0010WFPGetInfo0029HSERVICE=2, SrvcVersion=3(03)01194294967295024000001839490003CDM0003SPI00102022/06/06001205:18 10.4470007XFS_CMD0012GETINFO[303]0155hResult[0] = WFPGetInfo(
	hService = [2],
	dwCategory = [303],
	dwTimeOut = [300000],
	hWnd = [0x000200c4],
	ReqID = [159],
	lpQueryDetails = NULL
)02404294967295022100001839500006COMMON0009FRAMEWORK00102022/06/06001205:18 ";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(nwLogLine)));

         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("lpBuffer = NULL\r\n}"));
      }

      [TestMethod]
      public void Find_WFS_CMD_CDM_RETRACT()
      {
         Assert.IsTrue(true);
      }

      [TestMethod]
      public void Find_WFS_CMD_CDM_RESET()
      {
         Assert.IsTrue(true);
      }

      [TestMethod]
      public void Find_WFS_SRVE_CDM_CASHUNITINFOCHANGED()
      {
         Assert.IsTrue(true);
      }

      [TestMethod]
      public void Find_WFS_SRVE_CDM_ITEMSTAKEN()
      {
         Assert.IsTrue(true);
      }

      [TestMethod]
      public void Find_WFS_INF_CIM_STATUS()
      {
         string nwLogLine =
@"02444294967295022400090654590006COMMON0009FRAMEWORK00102023/01/24001221:44 48.0680011INFORMATION0033CSpCmdDispatcher::DispatchCommand0105pService->GetInfo() {HSERVICE[12], HWND[0x000201e0], REQUESTID[9748], dwCmdCode[1301], dwTimeOut[300000]}02244294967295019100090654600003CIM0007ACTIVEX00102023/01/24001221:44 48.0690006XFSAPI0017CService::GetInfo0098WFSAsyncGetInfo(hService=12, dwCategory=1301, lpQueryDetails=0x00000000, RequestID=9748) hResult=001914294967295016600090654610006COMMON0009FRAMEWORK00102023/01/24001221:44 48.0690011INFORMATION0028CServiceProvider::GetService0052service OK {HSERVICE[12], LogicalName[CashAcceptor]}01664294967295016800090654620003CDM0009FRAMEWORK00102023/01/24001221:44 48.0690011INFORMATION0021CBaseService::GetInfo0064Srvc=1301 ReqID=9748 Wnd=0x000201E0 Cmd=1301 TimeOut=300000 IO=201684294967295015800090654630012CashAcceptor0009FRAMEWORK00102023/01/24001221:44 48.0690007DEVCALL0021CBaseService::GetInfo0049HSERVICE[12] CATEGORY[1301] IN BUFFER[0x00000000]01584294967295017100090654640012CashAcceptor0009FRAMEWORK00102023/01/24001221:44 48.0690007DEVRETN0021CBaseService::GetInfo0062HSERVICE[12] CATEGORY[1301] HRESULT[0], OUT BUFFER[0x1F7E354C]01714294967295160800090654650003CIM0003SPI00102023/01/24001221:44 48.0690009XFS_EVENT0013GETINFO[1301]1520WFS_GETINFO_COMPLETE, 
lpResult =
{
	hWnd = [0x000201e0],
	RequestID = [9748],
	hService = [12],
	tsTimestamp = [2023/01/24 21:44 48.069],
	hResult = [0],
	u.dwCommandCode = [1301],
	lpBuffer = [0x258c7bdc]
	{
		fwDevice = [0],
		fwSafeDoor = [1],
		fwAcceptor = [1],
		fwIntermediateStacker = [0],
		fwStackerItems = [4],
		bDropBox = [0],
		lppPositions =
		{
			fwPosition = [4],
			fwShutter = [1],
			fwPositionStatus = [0],
			fwTransport = [0],
			fwTransportStatus = [0]
		}
		{
			fwPosition = [512],
			fwShutter = [1],
			fwPositionStatus = [0],
			fwTransport = [0],
			fwTransportStatus = [0]
		}
		lpszExtra = [BCMode=REAL-NOTE,BRM20SensorInfo=[1][4][5][0][0][0][0][0][3][2][2][2][2][1][1][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][3][1][1][1][1][1][1][1][4][3][3][4][4][3][0][0][3][0][0][3][2][4][0][0][6][6][6][0][0][0][3][0][1][0][0][0][0][0][0][0][...]
		dwGuidLights =
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000],
			[0x00000000], [0x00000000], [0x00000000], [0x00000000]
		wDevicePosition = [0],
		usPowerSaveRecoveryTime = [0]
		wMixedMode = [0]
		wAntiFraudModule = [0]
	}
}16084294967295019900090654660003CIM0007ACTIVEX00102023/01/24001221:44 48.0700006XFSAPI0023CContextMgr::MgrWndProc0100WFS_GETINFO_COMPLETE(RequestID=9748, hService=12, hResult=0, dwCommandCode=1301 lpBuffer=0x258C7BDC)01994294967295015900090654670003CIM0007ACTIVEX00102023/01/24001221:44 48.0700011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000407, wParam=0x3BBEFC50,";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(nwLogLine)));

         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("wAntiFraudModule = [0]\r\n\t}\r\n}"));
      }

      [TestMethod]
      public void Find_WFS_INF_CIM_CASH_UNIT_INFO()
      {
         string nwLogLine =
@"29104294967295015800090725860003CDM0007ACTIVEX00102023/01/24001221:46 30.5300011INFORMATION0025CCdmService::HandleStatus0052StStacker-old, StStacker-new : { EMPTY , NOTEMPTY }.01584294967295016700090725870003CDM0009FRAMEWORK00102023/01/24001221:46 30.5300011INFORMATION0021CBaseService::GetInfo0063Srvc=1303 ReqID=9980 Wnd=0x00020620 Cmd=1303 TimeOut=60000 IO=401674294967295016000090725880003CDM0007ACTIVEX00102023/01/24001221:46 30.5310005EVENT0041CCdmService::SetStackerStatusChangedEvent0044FireStackerStatusChanged{NewValue[NOTEMPTY]}01604294967295015800090725890012CashAcceptor0009FRAMEWORK00102023/01/24001221:46 30.5310007DEVCALL0021CBaseService::GetInfo0049HSERVICE[27] CATEGORY[1303] IN BUFFER[0x00000000]01584294967295016000090725900003CDM0007ACTIVEX00102023/01/24001221:46 30.5310011INFORMATION0025CCdmService::HandleStatus0054StPosition-old, StPosition-new : { EMPTY , NOTEMPTY }.01604294967295016200090725910003CDM0007ACTIVEX00102023/01/24001221:46 30.5320005EVENT0042CCdmService::SetPositionStatusChangedEvent0045FirePositionStatusChanged{NewValue[NOTEMPTY]}01624294967295019000090725920003CDM0007ACTIVEX00102023/01/24001221:46 30.5320011INFORMATION0024CContextMgr::SetComplete0085SetComplete(Waiting ReqID=[9977], Arrival ReqID=[9977]), Remove ReqID[9977] from List01904294967295017100090725930012CashAcceptor0009FRAMEWORK00102023/01/24001221:46 30.5320007DEVRETN0021CBaseService::GetInfo0062HSERVICE[27] CATEGORY[1303] HRESULT[0], OUT BUFFER[0x1F7E6494]01714294967295013500090725940003CDM0007ACTIVEX00102023/01/24001221:46 30.5320005EVENT0038CCdmService::HandleCashUnitInfoChanged0022FireCashUnitChanged[3]01354294967295022300090725950006COMMON0009FRAMEWORK00102023/01/24001221:46 30.5320011INFORMATION0033CSpCmdDispatcher::DispatchCommand0104pService->GetInfo() {HSERVICE[17], HWND[0x00010654], REQUESTID[9981], dwCmdCode[303], dwTimeOut[300000]}02234294967295016700090725960006COMMON0009FRAMEWORK00102023/01/24001221:46 30.5320011INFORMATION0028CServiceProvider::GetService0053service OK {HSERVICE[17], LogicalName[CashDispenser]}01674294967295291000090725970003CIM0003SPI00102023/01/24001221:46 30.5320009XFS_EVENT0013GETINFO[1303]2822WFS_GETINFO_COMPLETE, 
lpResult =
{
	hWnd = [0x00020620],
	RequestID = [9980],
	hService = [27],
	tsTimestamp = [2023/01/24 21:46 30.532],
	hResult = [0],
	u.dwCommandCode = [1303],
	lpBuffer = [0x007acd2c]
	{
		usCount=7
		lppCashIn->
		{
			usNumber		1		2		3		4		5		6		7
			fwType			4		5		1		1		1		1		2
			fwItemType		0x0001		0x0001		0x0004		0x0004		0x0004		0x0004		0x0003
			cUnitID			LCU00		LCU01		LCU02		LCU03		LCU04		LCU05		LCU06
			cCurrencyID		   		   		USD		USD		USD		USD		   
			ulValues		0		0		1		5		20		50		0
			ulCashInCount		0		1		13		0		17		17		49
			ulCount			0		1		3		0		0		0		49
			ulMaximum		80		210		0		0		0		0		1400
			usStatus		4		0		2		1		0		0		0
			bAppLock		0		0		0		0		0		0		0

			lppPhysical->
			usNumPhysicalCUs	1		1		1		1		1		1		1		
			lpPhysicalPositionName	RetractCassette	RejectCassette	CassetteA	CassetteB	CassetteC	CassetteD	CassetteE	
			cUnitID			RTCST		RJCST		CST_A		CST_B		CST_C		CST_D		CST_E
			ulCashInCount		0		1		13		0		17		17		49
			ulCount			0		1		3		0		0		0		49
			ulMaximum		80		210		0		0		0		0		1400
			usPStatus		4		0		2		1		0		0		0
			bHardwareSensor		1		1		1		1		1		1		1
			ulInitialCount		0		0		2000		2000		2000		2000		0
			ulDispensedCount	0		0		10		0		17		17		0		
			ulPresentedCount	0		0		0		0		16		17		0		
			ulRetractedCount	0		0		0		0		0		0		0		
			ulRejectCount		0		1		0		0		1		0		0
			lpszExtra(PCU)		[SerialNumber=NULLSERIALNUMBER]		[SerialNumber=NULLSERIALNUMBER]		[SerialNumber=CGJX501482]		[SerialNumber=CGJX501516]		[SerialNumber=CGJX501608]		[SerialNumber=CGJX469344]		[SerialNumber=CJOG203649]

			lpNoteNumberList->
			[0]			[1]0		[1]0		[1]3		[3]0		[5]0		[6]0		[1]0		
			[1]			[2]0		[2]0				[8]0		[10]0		[11]0		[2]0		
			[2]			[3]0		[3]0				[13]0		[15]0		[16]0		[3]0		
			[3]			[4]0		[4]0										[4]0		
			[4]			[5]0		[5]0										[5]0		
			[5]			[6]0		[6]0										[6]0		
			[6]			[7]0		[7]0										[7]0		
			[7]			[8]0		[8]0										[8]0		
			[8]			[9]0		[9]0										[9]0		
			[9]			[10]0		[10]0										[10]0		
			[10]			[11]0		[11]0										[11]0		
			[11]			[12]0		[12]0										[12]1		
			[12]			[13]0		[13]0										[13]3		
			[13]			[14]0		[14]0										[14]4		
			[14]			[15]0		[15]1										[15]0		
			[15]			[16]0		[16]0										[16]0		
			[16]			[17]0		[17]0										[17]41		
			[17]			[0]0		[0]0										[0]0		

			LCU ETC
			usCDMType		0		0		0		0		0		0		0
			lpszCashUnitName	LCU00		LCU01		LCU02		LCU03		LCU04		LCU05		LCU06		
			ulInitialCount		0		0		2000		2000		2000		2000		0
			ulDispensedCount	0		0		10		0		17		17		0		
			ulPresentedCount	0		0		0		0		16		17		0		
			ulRetractedCount	0		0		0		0		0		0		0		
			ulRejectCount		0		1		0		0		1		0		0
			ulMinimum		0		0		0		0		0		0		0
			lpszExtra(LCU)		NULL		NULL		NULL		NULL		NULL		NULL		NULL
		}
	}
}29104294967295016600090725980003CDM0009FRAMEWORK00102023/01/24001221:46 30.5330011INFORMATION0021CBaseService::GetInfo0062Srvc=303 ReqID=9981 Wnd=0x00010654 Cmd=303 TimeOut=300000 IO=301664294967295015800090725990013CashDispenser0009FRAMEWORK00102023/01/24001221:46 30.5330007DEVCALL0021CBaseService::GetInfo0048HSERVICE[17] CATEGORY[303] IN";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(nwLogLine)));

         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("NULL\r\n\t\t}\r\n\t}\r\n}"));
      }

      [TestMethod]
      public void Find_WFS_INF_CIM_CASH_IN_STATUS()
      {
         string nwLogLine =
@"02454294967295022500090887650006COMMON0009FRAMEWORK00102023/01/24001223:55 47.4390011INFORMATION0033CSpCmdDispatcher::DispatchCommand0106pService->GetInfo() {HSERVICE[12], HWND[0x000201e0], REQUESTID[10517], dwCmdCode[1307], dwTimeOut[300000]}02254294967295019200090887660003CIM0007ACTIVEX00102023/01/24001223:55 47.4390006XFSAPI0017CService::GetInfo0099WFSAsyncGetInfo(hService=12, dwCategory=1307, lpQueryDetails=0x00000000, RequestID=10517) hResult=001924294967295016600090887670006COMMON0009FRAMEWORK00102023/01/24001223:55 47.4400011INFORMATION0028CServiceProvider::GetService0052service OK {HSERVICE[12], LogicalName[CashAcceptor]}01664294967295016900090887680003CDM0009FRAMEWORK00102023/01/24001223:55 47.4400011INFORMATION0021CBaseService::GetInfo0065Srvc=1307 ReqID=10517 Wnd=0x000201E0 Cmd=1307 TimeOut=300000 IO=201694294967295015800090887690012CashAcceptor0009FRAMEWORK00102023/01/24001223:55 47.4410007DEVCALL0021CBaseService::GetInfo0049HSERVICE[12] CATEGORY[1307] IN BUFFER[0x00000000]01584294967295017100090887700012CashAcceptor0009FRAMEWORK00102023/01/24001223:55 47.4410007DEVRETN0021CBaseService::GetInfo0062HSERVICE[12] CATEGORY[1307] HRESULT[0], OUT BUFFER[0x1F7E7C44]01714294967295046600090887710003CIM0003SPI00102023/01/24001223:55 47.4410009XFS_EVENT0013GETINFO[1307]0378WFS_GETINFO_COMPLETE, 
lpResult =
{
	hWnd = [0x000201e0],
	RequestID = [10517],
	hService = [12],
	tsTimestamp = [2023/01/24 23:55 47.441],
	hResult = [0],
	u.dwCommandCode = [1307],
	lpBuffer = [0x0c5d121c]
	{
		wStatus = [2],
		usNumOfRefused = [0],
		lpNoteNumberList = 
		{
			usNumOfNoteNumbers = [0],
			lppNoteNumber = NULL
		}
		lpszExtra = NULL
	}
}04664294967295020000090887720003CIM0007ACTIVEX00102023/01/24001223:55 47.4410006XFSAPI0023CContextMgr::MgrWndProc0101WFS_GETINFO_COMPLETE(RequestID=10517, hService=12, hResult=0, dwCommandCode=1307 lpBuffer=0x0C5D121C)02004294967295015900090887730003CIM0007ACTIVEX00102023/01/24001223:55 47.4420011INFORMATION0022CMsgWnd::DefWindowProc0056message=0x00000407, wParam=0x1772FD80,";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(nwLogLine)));

         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("NULL\r\n\t}\r\n}"));

      }

      [TestMethod]
      public void Find_WFS_CMD_CIM_CASH_IN_START()
      {
         Assert.IsTrue(true); 
      }

      [TestMethod]
      public void Find_WFS_CMD_CIM_CASH_IN()
      {
         string logline = @"25754294967295016900055891050012CashAcceptor0009FRAMEWORK00102023/02/24001211:30 35.5370007DEVRETN0021CBaseService::Execute0060HSERVICE[12] COMMAND[1302] HRESULT[0] OUT BUFFER[0x0070679C]01694294967295012000055891060004CCIM0002SP00102023/02/24001211:30 35.5380011INFORMATION0017CCCIMDev::_Sensor0026BDS05 sensor changed(1->0)01204294967295012200055891070006COMMON0009FRAMEWORK00102023/02/24001211:30 35.5380011INFORMATION0015CProcessor::Run0021---- Wait [4588] ----01224294967295041400055891080003CIM0003SPI00102023/02/24001211:30 35.5380009XFS_EVENT0013EXECUTE[1302]0326WFS_EXECUTE_COMPLETE, 
lpResult =
{
	hWnd = [0x000200b6],
	RequestID = [3714],
	hService = [12],
	tsTimestamp = [2023/02/24 11:30 35.538],
	hResult = [0],
	u.dwCommandCode = [1302],
	lpBuffer = [0x1e3de4a4]

	{
		usNumOfNoteNumbers = [1],
		lppNoteNumber = 
		{
			usNoteID = [17],
			ulCount = [1]
		}
	}
}04144294967295012000055891090004CCIM0002SP00102023/02/24001211:30 35.5390011INFORMATION0017CCCIMDev::_Sensor0026BDS07 sensor changed(1->0)01204294967295013100055891100004CCIM0002SP00102023/02/24001211:30 35.5390007COMMAND0033CNHDevCommWrapper::Execute
";
         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(logline)));

         // Test TraceFileReader can detect end of line
         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("}"));

      }

      [TestMethod]
      public void Find_WFS_CMD_CIM_CASH_IN_END()
      {
         Assert.IsTrue(true);
      }

      [TestMethod]
      public void Find_WFS_CMD_CIM_CASH_IN_ROLLBACK()
      {
         string nwLogLine =
@"05024294967295016900316511240012CashAcceptor0009FRAMEWORK00102022 / 10 / 31001213:26 13.1110007DEVRETN0021CBaseService::Execute0060HSERVICE[13] COMMAND[1304] HRESULT[0] OUT BUFFER[0x00000000]01694294967295012200316511250006COMMON0009FRAMEWORK00102022 / 10 / 31001213:26 13.1110011INFORMATION0015CProcessor::Run0021---- Wait[5672]----01224294967295029800316511260003CIM0003SPI00102022 / 10 / 31001213:26 13.1110009XFS_EVENT0013EXECUTE[1304]0210WFS_EXECUTE_COMPLETE, 
lpResult =
{
            hWnd = [0x00020224],
	RequestID = [4498],
	hService = [13],
	tsTimestamp = [2022 / 10 / 31 13:26 13.111],
	hResult = [0],
	u.dwCommandCode = [1304],
	lpBuffer = NULL
}
         02984294967295012500316511270003BRM0002SP00102022 / 10 / 31001213:26 13.1450011INFORMATION0025CBrmCommand::UpdateStatus0024IdleStatus changed[0->1]01254294967295012800316511280009GUIDLIGHT0007ACTIVEX00102022 / 10 / 31001213:26 13.1630008PROPERTY0021Ctrl::GetDeviceStatus0023DeviceStatus[DEVONLINE]01284294967295012900316511290009GUIDLIGHT0007ACTIVEX00102022 / 10 / 31001213:26 13.1630008PROPERTY0024Ctrl::GetHasBillAcceptor0021HasBillAcceptor[TRUE]01294294967295014900316511300009GUIDLIGHT0007ACTIVEX00102022 / 10 / 31001213:26 13.1640006METHOD0018Ctrl::SetGuidLight0049Invoked {
            Device[BILLACCEPTOR], ";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(nwLogLine)));

         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("NULL\r\n}"));
      }

      [TestMethod]
      public void Find_WFS_CMD_CIM_RETRACT()
      {
         string nwLogLine =
@"03194294967295019300507215410006COMMON0009FRAMEWORK00102022/11/17001209:59 52.4730011INFORMATION0025CCommandQueue::RemoveHead0082return (bResult[1]) pCommand{hService[108],..., ReqID[56833], dwCommandCode[1305]}01934294967295012300507215420006COMMON0009FRAMEWORK00102022/11/17001209:59 52.4730011INFORMATION0015CProcessor::Run0022Execute{hService[108]}01234294967295016800507215430006COMMON0009FRAMEWORK00102022/11/17001209:59 52.4730011INFORMATION0028CServiceProvider::GetService0054service OK {HSERVICE[108], LogicalName[CashAcceptor1]}01684294967295015900507215440013CashAcceptor10009FRAMEWORK00102022/11/17001209:59 52.4730007DEVCALL0021CBaseService::Execute0049HSERVICE[108] COMMAND[1305] IN BUFFER[0x0060920C]01594294967295012100507215450004CCIM0002SP00102022/11/17001209:59 52.4730011INFORMATION0020CNHCCIMImpl::Execute0024call WFS_CMD_CIM_RETRACT01214294967295013600507215460004CCIM0002SP00102022/11/17001209:59 52.4890011INFORMATION0025CNHCCIMImpl::OnCimRetract0034CashInStatus : 0, DepositMode : 0101364294967295011500507215470004CCIM0002SP00102022/11/17001209:59 52.4900005ERROR0025CNHCCIMImpl::OnCimRetract0019No items to retract01154294967295013300507215480004CCIM0002SP00102022/11/17001209:59 52.4910011INFORMATION0020CNHCCIMImpl::Execute0036cash-in transaction ended by RETRACT01334294967295015100507215490004CCIM0002SP00102022/11/17001209:59 52.4930011INFORMATION0020CNHCCIMImpl::Execute0054dwCommand=[1305] hResult=[-1316] lpBuffer=[0x00000000]01514294967295017500507215500013CashAcceptor10009FRAMEWORK00102022/11/17001209:59 52.4940007DEVRETN0021CBaseService::Execute0065HSERVICE[108] COMMAND[1305] HRESULT[-1316] OUT BUFFER[0x00000000]01754294967295012200507215510006COMMON0009FRAMEWORK00102022/11/17001209:59 52.4940011INFORMATION0015CProcessor::Run0021---- Wait [6184] ----01224294967295031400507215520013CashAcceptor10003SPI00102022/11/17001209:59 52.4940009XFS_EVENT0013EXECUTE[1305]0216WFS_EXECUTE_COMPLETE, 
lpResult =
{
	hWnd = [0x0005077c],
	RequestID = [56833],
	hService = [108],
	tsTimestamp = [2022/11/17 09:59 52.494],
	hResult = [-1316],
	u.dwCommandCode = [1305],
	lpBuffer = NULL
}03144294967295012000507215530006COMMON0003SPI00102022/11/17001209:59 52.6410011INFORMATION0010WFPExecute0030HSERVICE=108, SrvcVersion=3.2001204294967295021900507215540006COMMON0009FRAMEWORK00102022/11/17001209:59 ";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(nwLogLine)));

         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("NULL\r\n}"));
      }

      [TestMethod]
      public void Find_WFS_CMD_CIM_RESET()
      {
         string nwLogLine =
@"05024294967295016800088601810003CDM0009FRAMEWORK00102023/01/24001211:19 13.5510011INFORMATION0021CBaseService::GetInfo0064Srvc=1303 ReqID=3034 Wnd=0x000201E0 Cmd=1303 TimeOut=300000 IO=201684294967295014000088601820003BRM0002SP00102023/01/24001211:19 13.5520011INFORMATION0019CMonitorThread::Run0045m_oldBrmCimInfo.LCU[i].ulValues changed(5->0)01404294967295015800088601830012CashAcceptor0009FRAMEWORK00102023/01/24001211:19 13.5520007DEVCALL0021CBaseService::GetInfo0049HSERVICE[12] CATEGORY[1303] IN BUFFER[0x00000000]01584294967295016900088601840012CashAcceptor0009FRAMEWORK00102023/01/24001211:19 13.5520007DEVRETN0021CBaseService::Execute0060HSERVICE[27] COMMAND[1313] HRESULT[0] OUT BUFFER[0x00000000]01694294967295014200088601850003BRM0002SP00102023/01/24001211:19 13.5520011INFORMATION0019CMonitorThread::Run0047m_oldBrmCimInfo.LCU[i].ulCount changed(2000->0)01424294967295018900088601860006COMMON0009FRAMEWORK00102023/01/24001211:19 13.5530011INFORMATION0025CCommandQueue::RemoveHead0078return (bResult[1]) pCommand{hService[2],..., ReqID[3032], dwCommandCode[321]}01894294967295029800088601870003CIM0003SPI00102023/01/24001211:19 13.5530009XFS_EVENT0013EXECUTE[1313]0210WFS_EXECUTE_COMPLETE, 
lpResult =
{
	hWnd = [0x00020620],
	RequestID = [3029],
	hService = [27],
	tsTimestamp = [2023/01/24 11:19 13.553],
	hResult = [0],
	u.dwCommandCode = [1313],
	lpBuffer = NULL
}02984294967295017100088601880012CashAcceptor0009FRAMEWORK00102023/01/24001211:19 13.5530007DEVRETN0021CBaseService::GetInfo0062HSERVICE[12] CATEGORY[1303] HRESULT[0], OUT BUFFER[0x0150B4B4]01714294967295014400088601890003BRM0002SP00102023/01/24001211:19 13.5530011INFORMATION0019CMonitorThread::Run0049m_oldBrmCimInfo.LCU[i].ulMaximum changed(0->1400)01444294967295012100088601900006COMMON0009FRAMEWORK00102023/01/24001211:19 ";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(nwLogLine)));

         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("NULL\r\n}"));

      }

      [TestMethod]
      public void Find_WFS_USRE_CIM_CASHUNITTHRESHOLD()
      {
         string nwLogLine =
@"02434294967295013700087580220003CDM0009FRAMEWORK00102023/01/24001208:31 09.8690011INFORMATION0028CBaseService::BroadcastEvent0026pData->wClass=3, wClass=1301374294967295019000087580230003CIM0007ACTIVEX00102023/01/24001208:31 09.8690006XFSAPI0017CService::GetInfo0097WFSAsyncGetInfo(hService=12, dwCategory=1303, lpQueryDetails=0x00000000, RequestID=525) hResult=001904294967295015900087580240003CDM0009FRAMEWORK00102023/01/24001208:31 09.8690011INFORMATION0028CBaseService::BroadcastEvent0048hApp=0x2AC211A2, pCursor->pData->hApp=0x2AC2292201594294967295013800087580250003CDM0009FRAMEWORK00102023/01/24001208:31 09.8700011INFORMATION0028CBaseService::BroadcastEvent0027pData->wClass=13, wClass=1301384294967295015900087580260003CDM0009FRAMEWORK00102023/01/24001208:31 09.8700011INFORMATION0028CBaseService::BroadcastEvent0048hApp=0x2AC22922, pCursor->pData->hApp=0x0BB0458201594294967295012600087580270003CIM0003SPI00102023/01/24001208:31 09.8700011INFORMATION0026CServiceAgent::ReportEvent0023call UnPack(0x2A7374C8)01264294967295013700087580280003CDM0009FRAMEWORK00102023/01/24001208:31 09.8700011INFORMATION0028CBaseService::BroadcastEvent0026pData->wClass=3, wClass=1301374294967295122400087580290003CIM0003SPI00102023/01/24001208:31 09.8710009XFS_EVENT0016USER_EVENT[1303]1133WFS_USER_EVENT, 
lpResult =
{
	hWnd = [0x000201e0],
	RequestID = [0],
	hService = [12],
	tsTimestamp = [2023/01/24 08:31 09.868],
	hResult = [0],
	u.dwEventID = [1303],
	lpBuffer = [0x086b88c4]
	{
		usNumber = [5],
		fwType = [1],
		fwItemType = [0x0004],
		cUnitID = [LCU04],
		cCurrencyID = [USD],
		ulValues = [20],
		ulCashInCount = [352],
		ulCount = [2154],
		ulMaximum = [0],
		usStatus = [2],
		bAppLock = [0],
		lpNoteNumberList = 
		{
			usNumOfNoteNumbers = [3],
			lppNoteNumber = 
			{
				usNoteID = [5],
				ulCount = [2154]
			}
			{
				usNoteID = [10],
				ulCount = [0]
			}
			{
				usNoteID = [15],
				ulCount = [0]
			}
		}
		usNumPhysicalCUs = [1],
		lppPhysical = 
		{
			lpPhysicalPositionName = [CassetteC],
			cUnitID = [CST_C],
			ulCashInCount = [352],
			ulCount = [2154],
			ulMaximum = [0],
			usPStatus = [2],
			bHardwareSensor = [1],
			lpszExtra = [SerialNumber=CGJX501608]
			ulInitialCount = [2000],
			ulDispensedCount = [198],
			ulPresentedCount = [198],
			ulRetractedCount = [0],
			ulRejectCount = [0],
		}
		lpszExtra = NULL
	}
}12244294967295015900087580300003CDM0009FRAMEWORK00102023/01/24001208:31 09.8710011INFORMATION0028CBaseService::BroadcastEvent0048hApp=0x0BB04582, pCursor->pData->hApp=0x0E770CEA01594294967295019000087580310003CIM0007ACTIVEX00102023/01/24001208:31 09.8710006XFSAPI0023CContextMgr::MgrWndProc0091WFS_USER_EVENT(RequestID=0, hService=12, hResult=0, dwCommandCode=1303 lpBuffer=0x086B88C4)01904294967295013800087580320003CDM0009FRAMEWORK00102023/01/24001208:31";

         StreamReader testStream = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(nwLogLine)));

         TraceFileReader reader = new TraceFileReader(testStream);
         string logLine = reader.ReadLine();
         Assert.IsTrue(logLine.EndsWith("NULL\r\n\t}\r\n}"));

      }

      [TestMethod]
      public void Find_WFS_SRVE_CIM_CASHUNITINFOCHANGED()
      {
         Assert.IsTrue(true);
      }

      [TestMethod]
      public void Find_WFS_SRVE_CIM_ITEMSTAKEN()
      {
         Assert.IsTrue(true);
      }

      [TestMethod]
      public void Find_WFS_EXEE_CIM_INPUTREFUSE()
      {
         Assert.IsTrue(true);
      }

      [TestMethod]
      public void Find_WFS_SRVE_CIM_ITEMSPRESENTED()
      {
         Assert.IsTrue(true);
      }

      [TestMethod]
      public void Find_WFS_SRVE_CIM_ITEMSINSERTED()
      {
         Assert.IsTrue(true);
      }

      [TestMethod]
      public void Find_WFS_EXEE_CIM_NOTEERROR()
      {
         Assert.IsTrue(true);
      }

      [TestMethod]
      public void Find_WFS_SRVE_CIM_MEDIADETECTED()
      {
         Assert.IsTrue(true);
      }


   }
}
